[platformio]
default_envs = openlux
extra_configs = .pio/board_override.ini

; ---------------------------------------------------------------------------
; Base configuration (common to all environments)
; ---------------------------------------------------------------------------
[env]
platform = espressif32 @ 6.12.0
board = esp32dev        ; change to your board if needed
framework = arduino
monitor_speed = 115200
monitor_filters = esp32_exception_decoder
upload_speed = 921600
extra_scripts =
    #pre:scripts/pio_hooks.py
    scripts/build_info.py
build_flags =
    -DMQTT_MAX_PACKET_SIZE=1024 ; Increase MQTT buffer for long status messages
lib_deps =
    esphome/AsyncTCP-esphome @ ^2.1.4
    WiFi
    ArduinoOTA
    ESPmDNS
    tzapu/WiFiManager @ ^2.0.17
    knolleary/PubSubClient @ ^2.8
upload_protocol = espota
upload_port = openlux.local      ; change to your device IP if needed
upload_flags =
    --auth=openlux123
    --port=3232
    --timeout=120

; ---------------------------------------------------------------------------
; Production (default)
; ---------------------------------------------------------------------------
[env:openlux]
platform = ${env.platform}
board = ${env.board}
framework = ${env.framework}
monitor_speed = ${env.monitor_speed}
monitor_filters = ${env.monitor_filters}
upload_speed = ${env.upload_speed}
build_flags =
    ${env.build_flags}
    -DCORE_DEBUG_LEVEL=3
    -DLOG_LOCAL_LEVEL=ESP_LOG_INFO
    -DOPENLUX_ENABLE_LOGGING=0
lib_deps = ${env.lib_deps}
upload_protocol = ${env.upload_protocol}
upload_port = ${env.upload_port}
upload_flags = ${env.upload_flags}

; ---------------------------------------------------------------------------
; Debug (more verbose logging)
; ---------------------------------------------------------------------------
[env:openlux-debug]
platform = ${env.platform}
board = ${env.board}
framework = ${env.framework}
monitor_speed = ${env.monitor_speed}
monitor_filters = ${env.monitor_filters}
upload_speed = ${env.upload_speed}
build_flags =
    ${env.build_flags}
    -DCORE_DEBUG_LEVEL=4    ; 0=NONE, 1=ERROR, 2=WARNING, 3=INFO, 4=DEBUG, 5=VERBOSE
    -DLOG_LOCAL_LEVEL=ESP_LOG_DEBUG
    -DOPENLUX_ENABLE_LOGGING=1
lib_deps = ${env.lib_deps}
upload_protocol = ${env.upload_protocol}
upload_port = ${env.upload_port}
upload_flags = ${env.upload_flags}
